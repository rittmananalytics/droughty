version: 2
models:
  - name: int_platform__bordereaux
    columns:
      - name: bordereaux_brokerage
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_fee
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_gross_discount
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_net
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_tax
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_tax_discount
        tests:
          - dbt_utils.at_least_one
      - name: business_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__bordereaux_fact
    columns:
      - name: bordereaux_brokerage
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_fee
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_gross_discount
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_net
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_tax
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_tax_discount
        tests:
          - dbt_utils.at_least_one
      - name: business_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__brokers
    columns:
      - name: broker_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_deleted_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_email_addresses
        tests:
          - dbt_utils.at_least_one
      - name: broker_name
        tests:
          - dbt_utils.at_least_one
      - name: broker_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_length_unit
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_length_value
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_rate
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_start_ts
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__invoices
    columns:
      - name: invoice_closed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_due_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_fees
        tests:
          - dbt_utils.at_least_one
      - name: invoice_gross_premium
        tests:
          - dbt_utils.at_least_one
      - name: invoice_local_currency
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_opened_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_payment_confirmed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_source_type
        tests:
          - dbt_utils.at_least_one
      - name: invoice_status
        tests:
          - dbt_utils.at_least_one
      - name: invoice_tax
        tests:
          - dbt_utils.at_least_one
      - name: invoice_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: payment_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__invoices_fact
    columns:
      - name: invoice_closed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_due_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_fees
        tests:
          - dbt_utils.at_least_one
      - name: invoice_gross_premium
        tests:
          - dbt_utils.at_least_one
      - name: invoice_local_currency
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_opened_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_payment_confirmed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_source_type
        tests:
          - dbt_utils.at_least_one
      - name: invoice_status
        tests:
          - dbt_utils.at_least_one
      - name: invoice_tax
        tests:
          - dbt_utils.at_least_one
      - name: invoice_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: payment_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__policies
    columns:
      - name: customer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: deposit_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: introducer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_business_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_currency
        tests:
          - dbt_utils.at_least_one
      - name: policy_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_holder
        tests:
          - dbt_utils.at_least_one
      - name: policy_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_installment_base
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_operation
        tests:
          - dbt_utils.at_least_one
      - name: policy_status
        tests:
          - dbt_utils.at_least_one
      - name: policy_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: policy_vertical
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: underwriter_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__policies_fact
    columns:
      - name: customer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: deposit_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: introducer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_business_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_currency
        tests:
          - dbt_utils.at_least_one
      - name: policy_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_holder
        tests:
          - dbt_utils.at_least_one
      - name: policy_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_installment_base
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_operation
        tests:
          - dbt_utils.at_least_one
      - name: policy_status
        tests:
          - dbt_utils.at_least_one
      - name: policy_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: policy_vertical
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: underwriter_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__products
    columns:
      - name: product_display_name
        tests:
          - dbt_utils.at_least_one
      - name: product_name
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: product_type
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__quotes
    columns:
      - name: business_type
        tests:
          - dbt_utils.at_least_one
      - name: customer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: discount_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: introducers
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_brokerage_premium
        tests:
          - dbt_utils.at_least_one
      - name: quote_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_currency
        tests:
          - dbt_utils.at_least_one
      - name: quote_excess
        tests:
          - dbt_utils.at_least_one
      - name: quote_fee
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_net_premium
        tests:
          - dbt_utils.at_least_one
      - name: quote_operation
        tests:
          - dbt_utils.at_least_one
      - name: quote_status
        tests:
          - dbt_utils.at_least_one
      - name: quote_tax
        tests:
          - dbt_utils.at_least_one
      - name: quote_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: underwriter_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__quotes_fact
    columns:
      - name: business_type
        tests:
          - dbt_utils.at_least_one
      - name: customer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: discount_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: introducers
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_brokerage_premium
        tests:
          - dbt_utils.at_least_one
      - name: quote_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_currency
        tests:
          - dbt_utils.at_least_one
      - name: quote_excess
        tests:
          - dbt_utils.at_least_one
      - name: quote_fee
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_net_premium
        tests:
          - dbt_utils.at_least_one
      - name: quote_operation
        tests:
          - dbt_utils.at_least_one
      - name: quote_status
        tests:
          - dbt_utils.at_least_one
      - name: quote_tax
        tests:
          - dbt_utils.at_least_one
      - name: quote_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: underwriter_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__schedules
    columns:
      - name: batch_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: business_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__schedules_fact
    columns:
      - name: batch_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: business_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: int_platform__vehicles
    columns:
      - name: vehicle_gross_weight_kg
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_manufacturer
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_model
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_type
        tests:
          - dbt_utils.at_least_one
  - name: stg_binders__products
    columns:
      - name: product_display_name
        tests:
          - dbt_utils.at_least_one
      - name: product_name
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: product_type
        tests:
          - dbt_utils.at_least_one
  - name: stg_motor__extended_quotations
    columns:
      - name: distance_unit
        tests:
          - dbt_utils.at_least_one
      - name: expected_mileage_per_vehicle
        tests:
          - dbt_utils.at_least_one
      - name: operation_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_motor__operations
    columns:
      - name: courier_operation_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: operation_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: self_drive_hire_operation_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: trades_operation_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_motor__premium_bands
    columns:
      - name: actuarial_fixed
        tests:
          - dbt_utils.at_least_one
      - name: premium_band_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: underwriter_fixed
        tests:
          - dbt_utils.at_least_one
  - name: stg_motor__quotation_vehicles
    columns:
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_vehicles_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_motor__vehicles
    columns:
      - name: vehicle_gross_weight_kg
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_manufacturer
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_model
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_type
        tests:
          - dbt_utils.at_least_one
  - name: stg_partners__brokers
    columns:
      - name: broker_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_deleted_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_email_addresses
        tests:
          - dbt_utils.at_least_one
      - name: broker_name
        tests:
          - dbt_utils.at_least_one
      - name: broker_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_length_unit
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_length_value
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_rate
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_start_ts
        tests:
          - dbt_utils.at_least_one
  - name: stg_partners__distributors
    columns:
      - name: broker_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_deleted_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_email_addresses
        tests:
          - dbt_utils.at_least_one
      - name: broker_name
        tests:
          - dbt_utils.at_least_one
      - name: broker_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_length_unit
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_length_value
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_rate
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_start_ts
        tests:
          - dbt_utils.at_least_one
  - name: stg_payments__charges
    columns:
      - name: payment_charges_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: payment_finalised_at
        tests:
          - dbt_utils.at_least_one
      - name: payment_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: payment_state
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__cancellations
    columns:
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__closed_invoices
    columns:
      - name: invoice_balance
        tests:
          - dbt_utils.at_least_one
      - name: invoice_closed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_due_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_source_type
        tests:
          - dbt_utils.at_least_one
      - name: payment_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__installment_transactions
    columns:
      - name: fees
        tests:
          - dbt_utils.at_least_one
      - name: installment_transaction_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: premium
        tests:
          - dbt_utils.at_least_one
      - name: taxes
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__open_invoices
    columns:
      - name: account_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_grace_period
        tests:
          - dbt_utils.at_least_one
      - name: invoice_local_currency
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_opened_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__policies
    columns:
      - name: created_by_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: customer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: deposit_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: external_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: introducer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: next_policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: payment_source_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_cancellation_grace_period
        tests:
          - dbt_utils.at_least_one
      - name: policy_contract_length
        tests:
          - dbt_utils.at_least_one
      - name: policy_contract_length_time_unit
        tests:
          - dbt_utils.at_least_one
      - name: policy_country_of_domicile
        tests:
          - dbt_utils.at_least_one
      - name: policy_currency
        tests:
          - dbt_utils.at_least_one
      - name: policy_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_holder
        tests:
          - dbt_utils.at_least_one
      - name: policy_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_number_of_installments
        tests:
          - dbt_utils.at_least_one
      - name: policy_state
        tests:
          - dbt_utils.at_least_one
      - name: policy_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: policy_vertical
        tests:
          - dbt_utils.at_least_one
      - name: previous_policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: product_type
        tests:
          - dbt_utils.at_least_one
      - name: underwriter_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__policy_capacity_providers
    columns:
      - name: partner_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_capacity_providers_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__policy_transactions
    columns:
      - name: fees
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_transaction_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: premium
        tests:
          - dbt_utils.at_least_one
      - name: taxes
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__quotation_distributors
    columns:
      - name: partner_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_distributor_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__quotations
    columns:
      - name: burning_cost_override
        tests:
          - dbt_utils.at_least_one
      - name: business_type
        tests:
          - dbt_utils.at_least_one
      - name: created_by_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: customer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: customer_type
        tests:
          - dbt_utils.at_least_one
      - name: discount_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: discount_price_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: excess_denominator
        tests:
          - dbt_utils.at_least_one
      - name: excess_numerator
        tests:
          - dbt_utils.at_least_one
      - name: external_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: introducer_gross_premium_split
        tests:
          - dbt_utils.at_least_one
      - name: next_quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: number_of_installments
        tests:
          - dbt_utils.at_least_one
      - name: policy_holder
        tests:
          - dbt_utils.at_least_one
      - name: product_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: product_type
        tests:
          - dbt_utils.at_least_one
      - name: quote_confirmed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_contract_length
        tests:
          - dbt_utils.at_least_one
      - name: quote_contract_length_time_unit
        tests:
          - dbt_utils.at_least_one
      - name: quote_country_of_domicile
        tests:
          - dbt_utils.at_least_one
      - name: quote_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_currency
        tests:
          - dbt_utils.at_least_one
      - name: quote_expires_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_expiry_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_rejected_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_request_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: quote_start_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_time_zone
        tests:
          - dbt_utils.at_least_one
      - name: quote_vertical
        tests:
          - dbt_utils.at_least_one
      - name: quote_voided_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: referrer_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: source_policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: technical_breakdown_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: total_price_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: underwriter_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: written_premium_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__renewing_policies
    columns:
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_renewal_invitation_period
        tests:
          - dbt_utils.at_least_one
      - name: policy_renewal_type
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__schedule_contents
    columns:
      - name: quote_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_content_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__schedule_transactions
    columns:
      - name: fees
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: premium
        tests:
          - dbt_utils.at_least_one
      - name: schedule_transaction_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: taxes
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__schedules
    columns:
      - name: batch_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: discount_price_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: external_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_content_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_type
        tests:
          - dbt_utils.at_least_one
      - name: schedule_voided_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: total_price_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__settled_invoices
    columns:
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_remaining_balance
        tests:
          - dbt_utils.at_least_one
      - name: invoice_settled_at_ts
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__voided_invoices
    columns:
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_voided_at_ts
        tests:
          - dbt_utils.at_least_one
  - name: stg_policies__written_premium_bordereau_entries
    columns:
      - name: bordereaux_brokerage
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_fee
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_gross_discount
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_net
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_tax
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_tax_discount
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_natural_key
        tests:
          - dbt_utils.at_least_one
  - name: stg_pricing__premiums
    columns:
      - name: written_premium_brokerage
        tests:
          - dbt_utils.at_least_one
      - name: written_premium_fee
        tests:
          - dbt_utils.at_least_one
      - name: written_premium_gross_discount
        tests:
          - dbt_utils.at_least_one
      - name: written_premium_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: written_premium_net
        tests:
          - dbt_utils.at_least_one
      - name: written_premium_tax
        tests:
          - dbt_utils.at_least_one
      - name: written_premium_tax_discount
        tests:
          - dbt_utils.at_least_one
  - name: stg_pricing__technical_premiums
    columns:
      - name: technical_premium_brokerage
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_burning_cost
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_combined_ratio
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_fee_scale
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_fee_shift
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_insurer_expenses
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_tax_scale
        tests:
          - dbt_utils.at_least_one
      - name: technical_premium_tax_shift
        tests:
          - dbt_utils.at_least_one
  - name: wh_platform__bordereaux_fact
    columns:
      - name: bordereaux_brokerage
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_fee
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_gross_discount
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_net
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_pk
        tests:
          - not_null
          - unique
      - name: bordereaux_tax
        tests:
          - dbt_utils.at_least_one
      - name: bordereaux_tax_discount
        tests:
          - dbt_utils.at_least_one
      - name: business_type_fk
        tests:
          - not_null
      - name: policy_fk
        tests:
          - not_null
      - name: schedule_fk
        tests:
          - not_null
  - name: wh_platform__brokers_fact
    columns:
      - name: broker_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_email_addresses
        tests:
          - dbt_utils.at_least_one
      - name: broker_name
        tests:
          - dbt_utils.at_least_one
      - name: broker_pk
        tests:
          - not_null
          - unique
      - name: broker_remuneration_rate
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_start_ts
        tests:
          - dbt_utils.at_least_one
  - name: wh_platform__invoices_fact
    columns:
      - name: currency_fk
        tests:
          - not_null
      - name: invoice_closed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_due_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_fees
        tests:
          - dbt_utils.at_least_one
      - name: invoice_gross_premium
        tests:
          - dbt_utils.at_least_one
      - name: invoice_local_currency
        tests:
          - dbt_utils.at_least_one
      - name: invoice_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: invoice_opened_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_payment_confirmed_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: invoice_pk
        tests:
          - not_null
          - unique
      - name: invoice_source_type
        tests:
          - dbt_utils.at_least_one
      - name: invoice_status
        tests:
          - dbt_utils.at_least_one
      - name: invoice_tax
        tests:
          - dbt_utils.at_least_one
      - name: payment_fk
        tests:
          - not_null
      - name: policy_fk
        tests:
          - not_null
      - name: timezone_fk
        tests:
          - not_null
  - name: wh_platform__policies_fact
    columns:
      - name: claim_fk
        tests:
          - not_null
      - name: currency_fk
        tests:
          - not_null
      - name: customer_fk
        tests:
          - not_null
      - name: deposit_fk
        tests:
          - not_null
      - name: introducer_fk
        tests:
          - not_null
      - name: policy_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_business_type
        tests:
          - dbt_utils.at_least_one
      - name: policy_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_holder
        tests:
          - dbt_utils.at_least_one
      - name: policy_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: policy_installment_base
        tests:
          - dbt_utils.at_least_one
      - name: policy_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: policy_operation
        tests:
          - dbt_utils.at_least_one
      - name: policy_pk
        tests:
          - not_null
          - unique
      - name: policy_status
        tests:
          - dbt_utils.at_least_one
      - name: policy_vertical
        tests:
          - dbt_utils.at_least_one
      - name: product_fk
        tests:
          - not_null
      - name: timezone_fk
        tests:
          - not_null
      - name: underwriter_fk
        tests:
          - not_null
  - name: wh_platform__products_dim
    columns:
      - name: product_display_name
        tests:
          - dbt_utils.at_least_one
      - name: product_name
        tests:
          - dbt_utils.at_least_one
      - name: product_pk
        tests:
          - not_null
          - unique
      - name: product_type
        tests:
          - dbt_utils.at_least_one
  - name: wh_platform__quotes_fact
    columns:
      - name: business_type_fk
        tests:
          - not_null
      - name: currency_fk
        tests:
          - not_null
      - name: customer_fk
        tests:
          - not_null
      - name: discount_fk
        tests:
          - not_null
      - name: introducer_fk
        tests:
          - not_null
      - name: product_fk
        tests:
          - not_null
      - name: quote_brokerage_premium
        tests:
          - dbt_utils.at_least_one
      - name: quote_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: quote_excess
        tests:
          - dbt_utils.at_least_one
      - name: quote_fee
        tests:
          - dbt_utils.at_least_one
      - name: quote_net_premium
        tests:
          - dbt_utils.at_least_one
      - name: quote_operation
        tests:
          - dbt_utils.at_least_one
      - name: quote_pk
        tests:
          - not_null
          - unique
      - name: quote_status
        tests:
          - dbt_utils.at_least_one
      - name: quote_tax
        tests:
          - dbt_utils.at_least_one
      - name: timezone_fk
        tests:
          - not_null
      - name: underwriter_fk
        tests:
          - not_null
  - name: wh_platform__schedules_fact
    columns:
      - name: batch_fk
        tests:
          - not_null
      - name: business_type_fk
        tests:
          - not_null
      - name: policy_fk
        tests:
          - not_null
      - name: quote_fk
        tests:
          - not_null
      - name: schedule_bound_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_end_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_inception_ts
        tests:
          - dbt_utils.at_least_one
      - name: schedule_natural_key
        tests:
          - dbt_utils.at_least_one
      - name: schedule_pk
        tests:
          - not_null
          - unique
  - name: wh_platform__vehicles_dim
    columns:
      - name: vehicle_gross_weight_kg
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_manufacturer
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_model
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_pk
        tests:
          - not_null
          - unique
      - name: vehicle_type
        tests:
          - dbt_utils.at_least_one
  - name: wh_platform_brokers_fact
    columns:
      - name: broker_created_at_ts
        tests:
          - dbt_utils.at_least_one
      - name: broker_email_addresses
        tests:
          - dbt_utils.at_least_one
      - name: broker_name
        tests:
          - dbt_utils.at_least_one
      - name: broker_pk
        tests:
          - not_null
          - unique
      - name: broker_remuneration_rate
        tests:
          - dbt_utils.at_least_one
      - name: broker_remuneration_start_ts
        tests:
          - dbt_utils.at_least_one
  - name: wh_platform_products_dim
    columns:
      - name: product_display_name
        tests:
          - dbt_utils.at_least_one
      - name: product_name
        tests:
          - dbt_utils.at_least_one
      - name: product_pk
        tests:
          - not_null
          - unique
      - name: product_type
        tests:
          - dbt_utils.at_least_one
  - name: wh_platform_vehicles_dim
    columns:
      - name: vehicle_gross_weight_kg
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_manufacturer
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_model
        tests:
          - dbt_utils.at_least_one
      - name: vehicle_pk
        tests:
          - not_null
          - unique
      - name: vehicle_type
        tests:
          - dbt_utils.at_least_one
